#!/usr/bin/env bash

echo "Installing VSCode..."
script-pkg-add visual-studio-code-bin

mkdir -p "$XDG_DATA_HOME/vscode" "$XDG_CONFIG_HOME/Code/User"

cat > "$XDG_DATA_HOME/vscode/argv.json" << 'EOF'
// This configuration file allows you to pass permanent command line arguments to VS Code.
// Only a subset of arguments is currently supported to reduce the likelihood of breaking
// the installation.
//
// PLEASE DO NOT CHANGE WITHOUT UNDERSTANDING THE IMPACT
//
// NOTE: Changing this file requires a restart of VS Code.
{
  "password-store":"gnome-libsecret"
}
EOF

# Ensure VSC's own auto-update feature is turned off
printf '{\n  "update.mode": "none"\n}\n' > "$XDG_CONFIG_HOME/Code/User/settings.json"

setsid gtk-launch code
