#!/usr/bin/env bash

usage() {
  echo "Usage: $0
    [-h | --help] <Print this help>
    [-i | --input] Input file
    [-o | --output] Output file"
  exit 2
}

ARG_NUM=$#
PARSED_ARGUMENTS=$(getopt -a -n "$0" -o i:,o:,h -l input:,output:,help -- "$@")
VALID_ARGUMENTS=$?

if [[ "$VALID_ARGUMENTS" != "0" || "$ARG_NUM" == "0" ]]; then
  usage
fi

eval set -- "$PARSED_ARGUMENTS"

while :; do
  case "${1}" in
  -i | --input)
    input="${2}"
    shift 2
    ;;
  -o | --output)
    output="${2}"
    shift 2
    ;;
  --)
    shift
    break
    ;;
  *)
    echo "Unexpected option: $1 - this should not happen."
    usage
    ;;
  esac
done

# Use the python inside the venv to run the script
exec "${HOME}/.local/venvs/unoserver/bin/python" "$HOME/.local/bin/scripts/unoconvert_firstpage_pdf.py" "$input" "$output"
